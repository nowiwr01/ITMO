start: s
accept: accepted
reject: rejected
blank: _
s 0 -> find_last_number 0 >
s 1 -> find_last_number 1 >

find_last_number 0 -> find_last_number 0 >
find_last_number 1 -> find_last_number 1 >
find_last_number # -> find_last_number # >
find_last_number * -> find_last_number * >
find_last_number _ -> copy_last_number * <

copy_last_number 0 -> copy_last_number 0 <
copy_last_number 1 -> copy_last_number 1 <
copy_last_number * -> take_digit * >
copy_last_number _ -> take_digit _ >
copy_last_number 2 -> take_digit 2 >
copy_last_number 3 -> take_digit 3 >

take_digit 0 -> copied_0 2 >
take_digit 1 -> copied_1 3 >

copied_0 0 -> copied_0 0 >
copied_0 1 -> copied_0 1 >
copied_0 * -> put_zero * >
copied_1 0 -> copied_1 0 >
copied_1 1 -> copied_1 1 >
copied_1 * -> put_one * >

put_zero 0 -> put_zero 0 >
put_zero 1 -> put_zero 1 >
put_zero _ -> return_to_last_number 0 <

put_one 0 -> put_one 0 >
put_one 1 -> put_one 1 >
put_one _ -> return_to_last_number 1 <

return_to_last_number 0 -> return_to_last_number 0 <
return_to_last_number 1 -> return_to_last_number 1 <
return_to_last_number * -> copy_last_number * <

take_digit * -> minus_one_last_number * >

minus_one_last_number 0 -> minus_one_last_number 0 >
minus_one_last_number 1 -> minus_one_last_number 1 >
minus_one_last_number _ -> minus_one _ <

minus_one 0 -> minus_one 1 <
minus_one 1 -> find_start 0 <
minus_one * -> find_end_to_delete * >

find_start 0 -> find_start 0 <
find_start 1 -> find_start 1 <
find_start * -> find_last_number * >

find_end_to_delete 0 -> find_end_to_delete 0 >
find_end_to_delete 1 -> find_end_to_delete 1 >
find_end_to_delete _ -> delete_first _ <

delete_first 0 -> delete_first _ <
delete_first 1 -> delete_first _ <
delete_first * -> delete_second _ <

delete_second 2 -> delete_second _ <
delete_second * -> return _ <

return # -> return # <
return * -> return * <
return 2 -> return 0 <
return 3 -> return 1 <
return _ -> check_right _ >

check_right 1 -> check_right 1 >
check_right 0 -> check_right 0 >
check_right _ -> accepted _ <
check_right * -> init * <

init 0 -> init 0 <
init 1 -> init 1 <
init _ -> find_end # >

find_end 0 -> find_end 0 >
find_end 1 -> find_end 1 >
find_end - -> find_end - >
find_end * -> find_real_end * >
find_end _ -> minus_one(multiplication) _ <

find_real_end 0 -> find_real_end 0 >
find_real_end 1 -> find_real_end 1 >
find_real_end - -> find_real_end - >
find_real_end * -> minus_one(multiplication) * <
find_real_end _ -> minus_one(multiplication) _ <

minus_one(multiplication) 0 -> minus_one(multiplication) 1 <
minus_one(multiplication) 1 -> find_start(multiplication) 0 <

find_start(multiplication) 0 -> find_start(multiplication) 0 <
find_start(multiplication) 1 -> find_start(multiplication) 1 <
find_start(multiplication) * -> plus * <

plus - -> plus - <
plus 0 -> plus_zero 2 <
plus_zero 0 -> plus_zero 0 <
plus_zero 1 -> plus_zero 1 <
plus_zero * -> plus_zero * <
plus_zero # -> add_zero # <

add_zero 2 -> add_zero 2 <
add_zero 3 -> add_zero 3 <
add_zero 0 -> add_more 2 >
add_zero 1 -> add_more 3 >
add_zero _ -> add_more 2 >

add_more 0 -> add_more 0 >
add_more 1 -> add_more 1 >
add_more 2 -> add_more 2 >
add_more 3 -> add_more 3 >
add_more # -> find_digit # >

find_digit 0 -> find_digit 0 >
find_digit 1 -> find_digit 1 >
find_digit * -> find_digit * >
find_digit 2 -> plus 2 <
find_digit 3 -> plus 3 <

plus 1 -> plus_one 3 <
plus_one 0 -> plus_one 0 <
plus_one 1 -> plus_one 1 <
plus_one * -> plus_one * <
plus_one # -> add_one # <

add_one 2 -> add_one 2 <
add_one 3 -> add_one 3 <
add_one 0 -> add_more 3 >
add_one _ -> add_more 3 >
add_one 1 -> carry 2 <

carry 1 -> carry 0 <
carry 0 -> add_more 1 >
carry _ -> add_more 1 >

plus # -> clean_backward # <

clean_backward 3 -> clean_backward 1 <
clean_backward 2 -> clean_backward 0 <
clean_backward 1 -> clean_backward 1 <
clean_backward 0 -> clean_backward 0 <
clean_backward _ -> clean_forward _ >

clean_forward 0 -> clean_forward 0 >
clean_forward - -> clean_forward - >
clean_forward 1 -> clean_forward 1 >
clean_forward # -> clean_forward # >
clean_forward 2 -> clean_forward 0 >
clean_forward 3 -> clean_forward 1 >
clean_forward * -> find_real_end * >

minus_one(multiplication) * -> clean * >

clean 0 -> clean - >
clean 1 -> clean - >
clean * -> delete_multiplier * <

delete_multiplier - -> delete_multiplier - <
delete_multiplier 1 -> delete_multiplier - <
delete_multiplier 0 -> delete_multiplier - <
delete_multiplier * -> delete_multiplier - <
delete_multiplier # -> init - <

clean _ -> find_star _ <

find_star _ -> find_star _ <
find_star 0 -> find_star _ <
find_star 1 -> find_star _ <
find_star - -> find_star _ <
find_star * -> find_hash _ <

find_hash 0 -> find_hash _ <
find_hash 1 -> find_hash _ <
find_hash - -> find_hash _ <
find_hash # -> find_head _ <

find_head 0 -> find_head_found_something 0 <
find_head 1 -> find_head_found_something 1 <
find_head_found_something 0 -> find_head_found_something 0 <
find_head_found_something 1 -> find_head_found_something 1 <
find_head_found_something _ -> accepted _ >
find_head _ -> accepted 0 ^